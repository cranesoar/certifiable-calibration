%
% Copyright © 2012, The Massachusetts Institute of Technology. All rights reserved. 
%
% THE LICENSOR EXPRESSLY DISCLAIMS ANY AND ALL WARRANTIES CONCERNING THIS 
% SOFIWARE AND DOCUMENTATION, INCLUDING ANY WARRANTIES OF MERCHANTABILITY, 
% FITNESS FOR ANY PARTICULAR PURPOSE, NON- INFRINGEMENT AND WARRANTIES OF 
% PERFORMANCE, AND ANY WARRANTY THAT MIGHT OTHERWISE ARISE FROM COURSE OF 
% DEALING OR USAGE OF TRADE. NO WARRANTY IS EITHER EXPRESS OR IMPLIED WITH 
% RESPECT TO THE USE OF THE SOFIWARE OR DOCUMENTATION. Under no circumstances 
% shall the Licensor be liable for incidental, special, indirect, direct or 
% consequential damages, or loss of profits, interruption of business, or 
% related expenses which may arise from use of Software or Documentation, 
% including but not limited to those resulting from defects in Software 
% and/or Documentation, or loss or inaccuracy of data of any kind. 
%
% This software is licensed under the "LIMITED RESEARCH LICENSE (SOURCE
% CODE)" as described in the included LICENSE.txt
%
% Please cite the paper below if you are using this software in your work:
% Brookshire, J.; Teller, S. Extrinsic Calibration from Per-Sensor Egomotion. 
%   Robotics: Science and Systems, 2012.
%
function y=JAvgSubmat0(qa0,qa1,qa2,qa3,qa4,qa5,qa6,qa7,b0,b1,b2,b3,b4,b5,b6,b7,wa)
y=[(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1)+b0.^2.*...
qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*...
b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+(b1.*qa0+(-1).*...
b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*...
atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)+((-1).*b0.*qa0+(-1).*b1.*qa1+(-1).*b2.*qa2+(-1).*...
b3.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(-3/2).*wa.*((b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*((-1)+b0.^2.*qa0.^2+b1.^2.*...
qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*...
qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+(-1).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+(b3.*qa0+(-1).*...
b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(-3/2).*wa.*(((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1)+b0.^2.*...
qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*...
b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1)...
.*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3)+((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),0,0,0;(1/2).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*((-1)+b0.^2.*qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*...
b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*...
qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).^(-1/2)+(-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(...
(-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(...
1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(-3/2).*wa.*((b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(...
(-1)+b0.^2.*qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*qa2.*...
qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*...
qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(-1/2)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+((-1).*b0.*qa0+(-1).*b1.*...
qa1+(-1).*b2.*qa2+(-1).*b3.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(-3/2).*wa.*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1)+b0.^2.*...
qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*...
b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+(-1).*((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1)...
.*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),0,0,0;(1/2).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*(((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1)...
.*b2.*qa3).*((-1)+b0.^2.*qa0.^2+b1.^2.*qa1.^2+b2.^2.*qa2.^2+2.*b2.*b3.*...
qa2.*qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*qa2+b3.*qa3)+2.*b0.*qa0.*(b1.*...
qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(-1/2)+((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*...
atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*((-1)+b0.^2.*qa0.^2+b1.^2.*qa1.^2+b2.^2.*...
qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*qa2+b3.*...
qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+(-1).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2.*((-1)+b0.^2.*qa0.^2+b1.^2.*qa1.^2+b2.^2.*...
qa2.^2+2.*b2.*b3.*qa2.*qa3+b3.^2.*qa3.^2+2.*b1.*qa1.*(b2.*qa2+b3.*...
qa3)+2.*b0.*qa0.*(b1.*qa1+b2.*qa2+b3.*qa3)).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-1/2)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*...
b0.*qa3).^2.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3)+((-1).*b0.*qa0+(-1).*b1.*qa1+(-1).*b2.*qa2+(-1).*b3.*qa3).*(1+(-1)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),0,0,0;...
(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*wa.*((...
3/2).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*(2.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*qa0+b5.*...
qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*(((-3)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*qa0+b4.*...
qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*...
qa7)+2.*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*qa0+(-1).*...
b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*...
b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*...
b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7))).*atan2((1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*...
qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(b1.*qa0+(-1).*b0.*...
qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*...
qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(...
1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*...
qa7)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(((-3)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*...
b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+2.*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1)...
.*b0.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*...
b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1)...
.*b0.*qa6+(-1).*b1.*qa7)))+(-1).*((1/2).*((-3)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b4.*qa0+(-1).*b5.*qa1+(-1).*...
b6.*qa2+(-1).*b7.*qa3+(-1).*b0.*qa4+(-1).*b1.*qa5+(-1).*b2.*qa6+(-1).*...
b3.*qa7)+((-1).*b0.*qa0+(-1).*b1.*qa1+(-1).*b2.*qa2+(-1).*b3.*qa3).*((...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b7.*qa0+(-1).*b6.*...
qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b6.*qa0+b7.*qa1+(-1).*...
b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7))).*...
atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(-5/2).*wa.*((3/2).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(2.*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)...
.*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1)...
.*(((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)+2.*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*...
qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*...
qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7))).*atan2(...
(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*(...
(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b6.*qa0+b7.*qa1+(-1).*b4.*...
qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(...
b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1/2)...
.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*...
qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+2.*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*...
qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*...
b0.*qa6+(-1).*b1.*qa7)))+(-1).*((1/2).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*...
qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+2.*((-1).*b2.^2.*qa0.*...
qa2+b3.^2.*qa0.*qa2+(-2).*b2.*b3.*qa1.*qa2+(-2).*b2.*b3.*qa0.*...
qa3+b2.^2.*qa1.*qa3+(-1).*b3.^2.*qa1.*qa3+b0.^2.*(qa0.*qa2+(-1).*qa1.*...
qa3)+b1.^2.*((-1).*qa0.*qa2+qa1.*qa3)+b1.*b3.*((-1).*qa0.^2+(-1).*...
qa1.^2+qa2.^2+qa3.^2)+b0.*(2.*b1.*(qa1.*qa2+qa0.*qa3)+b2.*((-1).*...
qa0.^2+(-1).*qa1.^2+qa2.^2+qa3.^2))).*((-1).*b5.*qa0+b4.*qa1+b7.*...
qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*((b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*...
qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*...
qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7))+((-1).*b1.*qa0+b0.*qa1+b3.*...
qa2+(-1).*b2.*qa3).*((b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(...
b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*...
qa6+(-1).*b0.*qa7)+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b6.*...
qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*...
qa6+b1.*qa7)+(-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*((-1)...
.*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*...
qa6+(-1).*b2.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7))).*atan2((...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(-5/2).*wa.*((3/2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(2.*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)...
.*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1)...
.*(((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)+2.*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*...
qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*...
qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7))).*atan2(...
(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*(...
(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b7.*qa0+(-1).*b6.*qa1+b5.*...
qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+((-1).*...
b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*...
qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1)...
.*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1/2).*(...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*...
qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+2.*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*...
qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*...
b0.*qa6+(-1).*b1.*qa7)))+(-1).*((1/2).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*...
qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*(2.*b2.*b3.*qa0.*...
qa2+(-1).*b2.^2.*qa1.*qa2+b3.^2.*qa1.*qa2+(-1).*b2.^2.*qa0.*qa3+b3.^2.*...
qa0.*qa3+(-2).*b2.*b3.*qa1.*qa3+(-1).*b0.^2.*(qa1.*qa2+qa0.*qa3)+b1.^2.*...
(qa1.*qa2+qa0.*qa3)+b0.*b3.*(qa0.^2+qa1.^2+(-1).*qa2.^2+(-1).*...
qa3.^2)+b1.*(2.*b0.*(qa0.*qa2+(-1).*qa1.*qa3)+b2.*((-1).*qa0.^2+(-1).*...
qa1.^2+qa2.^2+qa3.^2))).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*...
qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+((-1).*b2.*qa0+(-1).*...
b3.*qa1+b0.*qa2+b1.*qa3).*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*...
qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*...
b0.*qa6+(-1).*b1.*qa7))+((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(...
(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*...
b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*((-1).*b6.*qa0+(-1).*b7.*...
qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(-1).*(...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b5.*qa0+(-1).*b4.*...
qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b4.*qa0+b5.*qa1+b6.*...
qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7))).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*(...
(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1/2).*((-1).*b0.*qa0+(-1).*...
b1.*qa1+(-1).*b2.*qa2+(-1).*b3.*qa3).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((-1).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1)...
.*(((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*...
qa3)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))+(1/2).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b1.*qa0+(-1).*b0.*...
qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2))...
.*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(-3/2).*wa.*((-1).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1).*(((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1/2).*(...
(-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-3)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).^2+3.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+3.*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3));(1/2).*(1+(-1)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*wa.*((3/2).*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(...
2.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*...
qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*(2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b7.*...
qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*...
qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*...
b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*...
qa6+b1.*qa7)+((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*...
b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b2.*qa0+(-1).*b3.*...
qa1+b0.*qa2+b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(...
(-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*...
qa6+(-1).*b2.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*((-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*...
b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b5.*...
qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*...
qa6+b2.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*((-1)...
.*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*...
qa5+b2.*qa6+b3.*qa7)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(2.*((-1)...
.*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*...
qa1+b0.*qa2+b1.*qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1)...
.*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).^2.*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*...
b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b6.*qa0+(-1).*b7.*...
qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*(...
(-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*...
qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))+(-1).*((-1).*(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2.*(b7.*qa0+(-1).*b6.*qa1+b5.*...
qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(-1/2).*(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b7.*qa0+(-1).*b6.*...
qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*...
qa7)+(-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*...
qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*...
qa6+b0.*qa7)+(1/2).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*...
qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1)...
.*b0.*qa6+(-1).*b1.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*...
(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*...
qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(2.*(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3)+(-3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*...
(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*...
qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(-1).*(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*...
qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*...
b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+(-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(b5.*qa0+(-1).*...
b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*...
qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*...
qa4+b1.*qa5+b2.*qa6+b3.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))),(1/2).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*wa.*((3/2).*((-1)...
.*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).*(2.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*(2.*((-1).*b3.*qa0+b2.*...
qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*...
qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*...
qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.^2.*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*...
b3.*qa5+b0.*qa6+b1.*qa7)+((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*...
qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b2.*...
qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1)...
.*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*...
qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).^(1/2).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*...
qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).^2.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*...
(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*qa0+b5.*...
qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1/2).*(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(-1/2).*(2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b6.*qa0+(-1).*...
b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(...
(-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*...
b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*...
qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*...
qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)...
)+(-1).*((-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*...
qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(...
(-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*...
b1.*qa6+b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*...
b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*...
qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(b1.^2.*qa0.*qa2+((-1).*b3.*...
qa0+b2.*qa1+b0.*qa3).*(b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(-1).*b1.*(b2.*...
qa0.*qa1+b0.*qa1.*qa2+b3.*((-1).*qa0.^2+qa2.^2)+b0.*qa0.*qa3+(-1).*b2.*...
qa2.*qa3)).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*...
qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*...
b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*...
qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(-1).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*...
qa5+(-1).*b3.*qa6+b2.*qa7)+(1/2).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b4.*qa0+(-1).*b5.*...
qa1+(-1).*b6.*qa2+(-1).*b7.*qa3+(-1).*b0.*qa4+(-1).*b1.*qa5+(-1).*b2.*...
qa6+(-1).*b3.*qa7)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.^2.*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7))...
.*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3))),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).^(-5/2).*wa.*((3/2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(2.*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*...
qa6+b3.*qa7)+(-1).*(2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(...
(-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b6.*qa0+(-1).*...
b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(...
(-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*...
b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*...
qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*...
qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))...
.*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).*((-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b7.*qa0+(-1).*b6.*qa1+b5.*...
qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)...
.*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*...
qa7)+(-1/2).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(2.*((-1).*b3.*qa0+b2.*...
qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*...
qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*...
qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.^2.*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*...
b3.*qa5+b0.*qa6+b1.*qa7)+((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*...
qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b2.*...
qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1)...
.*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*...
qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))+(-1).*((b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(b7.*...
qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*...
qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*...
qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+2.*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*...
b2.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*...
qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1)...
.*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(b3.*qa0+(-1)...
.*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+3.*(...
(-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3)).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*...
qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+(-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).^2.*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*...
qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(3/2).*(b1.*qa0+(-1).*b0.*...
qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*...
qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(1/2).*((-3)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*(...
b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*...
b3.*qa6+b2.*qa7)+(-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b4.*qa0+b5.*qa1+b6.*...
qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*(...
(-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*...
qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(1/2)+(-1).*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*...
qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+(-1/2).*(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*...
qa3).^2+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+(...
1/2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-3)+(b3.*qa0+(-1)...
.*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(-3/2).*wa.*((-1).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)...
.^2.*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1).*((b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)+(-1/2)...
.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)+(1/2).*((-1).*b0.*qa0+(-1).*b1.*qa1+(-1).*b2.*...
qa2+(-1).*b3.*qa3).*((-3)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2+3.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*(((-1).*b3.*qa0+b2.*...
qa1+(-1).*b1.*qa2+b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1/2).*(...
(-2).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b1.*qa0+(-1).*...
b0.*qa1+(-1).*b3.*qa2+b2.*qa3)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*...
qa3).^3+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*((-3)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).^2+3.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*...
b1.*qa3).^2+3.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3));(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*...
wa.*((3/2).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*((-2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*((...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*...
qa7)+3.*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*...
qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+2.*((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*...
qa2+b1.*qa3).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*...
qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).*((-1).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(1+(-1)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*((-1).*b5.*qa0+b4.*...
qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+(...
(-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*...
(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*...
qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*(b2.*qa0+b3.*qa1+(-1)...
.*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*...
qa7)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*((b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*...
qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*...
qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*...
qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+3.*((-1)+(b3.*qa0+(-1)...
.*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*...
qa5+(-1).*b1.*qa6+b0.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b6.*qa0+(-1)...
.*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*...
qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1)...
.*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))+(-1).*((-2).*(...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*...
qa3+b3.*qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(-1).*(b1.*qa0+(-1).*...
b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(b7.*...
qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*qa4+(-1).*b2.*qa5+b1.*...
qa6+(-1).*b0.*qa7)+3.*((-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)+(-1).*(b1.*qa0+(-1)...
.*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)).*(...
(-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*...
b1.*qa6+b0.*qa7)+(-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2.*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*...
b0.*qa6+(-1).*b1.*qa7)+(3/2).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).^2.*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*...
qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(3/2).*((-1)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*(...
b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*...
qa6+(-1).*b1.*qa7)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)...
.^2.*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*...
b3.*qa5+b0.*qa6+b1.*qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*...
(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*...
b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1)...
.*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*...
b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b4.*qa0+b5.*...
qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)).*atan2((1+(-1).*(...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3))),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*...
wa.*((3/2).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*((-2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*((...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*...
qa7)+3.*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*...
qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+2.*((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*...
qa2+b1.*qa3).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*...
qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).*(((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b6.*qa0+b7.*qa1+(-1).*b4.*...
qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*...
qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(...
b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1/2)...
.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*((b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*...
b1.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*...
qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*...
qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+3.*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b7.*...
qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*...
qa6+b0.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*...
b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*b6.*qa0+(-1).*b7.*...
qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*(...
(-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*...
qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))+(-1).*(2.*(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(b7.*qa0+(-1).*b6.*qa1+b5.*qa2+(-1).*b4.*qa3+b3.*...
qa4+(-1).*b2.*qa5+b1.*qa6+(-1).*b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*((-1).*b7.*...
qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*...
qa6+b0.*qa7)+3.*((b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*...
qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)+(-1).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)).*((-1).*b7.*...
qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*...
qa6+b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1)...
.*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(...
b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*...
qa6+(-1).*b1.*qa7)+(-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2.*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*...
qa5+b3.*qa6+(-1).*b2.*qa7)+(3/2).*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)+(-1/2).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b5.*...
qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*...
qa6+b2.*qa7)+(-3/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(...
b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*...
b3.*qa6+b2.*qa7)+(-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*(b4.*qa0+b5.*qa1+b6.*...
qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-5/2).*wa.*((...
3/2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3).*((-2).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*...
qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1).*((...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*...
qa7)+3.*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*...
qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+2.*((-1).*b3.*...
qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*...
qa2+b1.*qa3).*((-1).*b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*...
qa4+(-1).*b3.*qa5+b0.*qa6+b1.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*...
qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*...
qa0+b4.*qa1+b7.*qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*...
b2.*qa7)).*atan2((1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),...
b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3))+(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*...
qa3).^2).*((-1).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(1+(-1)...
.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2).*((-1).*b7.*qa0+b6.*...
qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(...
b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2.*(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*(...
b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(1/2).*(b4.*qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*...
qa6+b3.*qa7)+(-1/2).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-1/2).*((b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*...
qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b1.*qa0+(-1).*...
b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*...
qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+3.*((-1)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*...
qa2+b3.*qa3).^2).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*...
b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*...
b1.*qa2+b0.*qa3).*((-1).*b2.*qa0+(-1).*b3.*qa1+b0.*qa2+b1.*qa3).*((-1).*...
b6.*qa0+(-1).*b7.*qa1+b4.*qa2+b5.*qa3+(-1).*b2.*qa4+(-1).*b3.*qa5+b0.*...
qa6+b1.*qa7)+2.*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*...
b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*...
qa2+(-1).*b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7))+(-1).*((...
b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*((-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*...
qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*b1.*qa6+b0.*qa7)+(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).*(...
(-1).*b7.*qa0+b6.*qa1+(-1).*b5.*qa2+b4.*qa3+(-1).*b3.*qa4+b2.*qa5+(-1).*...
b1.*qa6+b0.*qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*((-1).*...
b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*...
qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*...
b3.*qa2+b2.*qa3).*(b6.*qa0+b7.*qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*...
qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*qa7)+(-1).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(b6.*qa0+b7.*...
qa1+(-1).*b4.*qa2+(-1).*b5.*qa3+b2.*qa4+b3.*qa5+(-1).*b0.*qa6+(-1).*b1.*...
qa7)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).*((-1).*b5.*qa0+b4.*qa1+b7.*qa2+(-1).*...
b6.*qa3+(-1).*b1.*qa4+b0.*qa5+b3.*qa6+(-1).*b2.*qa7)+(b3.*qa0+(-1).*b2.*...
qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*(b5.*qa0+(-1).*b4.*qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*...
qa5+(-1).*b3.*qa6+b2.*qa7)+(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).*(b5.*qa0+(-1).*b4.*...
qa1+(-1).*b7.*qa2+b6.*qa3+b1.*qa4+(-1).*b0.*qa5+(-1).*b3.*qa6+b2.*qa7)+(...
3/2).*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).^2+(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).*((-1).*b4.*qa0+(-1).*b5.*qa1+(-1).*...
b6.*qa2+(-1).*b7.*qa3+(-1).*b0.*qa4+(-1).*b1.*qa5+(-1).*b2.*qa6+(-1).*...
b3.*qa7)+(-1/2).*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b4.*...
qa0+b5.*qa1+b6.*qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)+(-1/2).*(...
b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2.*(b4.*qa0+b5.*qa1+b6.*...
qa2+b7.*qa3+b0.*qa4+b1.*qa5+b2.*qa6+b3.*qa7)).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*(...
(-1).*((-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*((-1).*b1.*qa0+b0.*...
qa1+b3.*qa2+(-1).*b2.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(1/2)+(-1/2).*((-2).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3)+(b2.*qa0+b3.*qa1+(-1)...
.*b0.*qa2+(-1).*b1.*qa3).^3+(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*...
qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^2+2.*(b3.*qa0+(-1)...
.*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*...
b2.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+3.*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*...
qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((1+(-1).*(b0.*...
qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(-3/2).*wa.*((...
(-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)...
.^(1/2)+(-1/2).*((-2).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2.*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(-1).*(b2.*qa0+b3.*...
qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*...
qa2+b2.*qa3)+(-1).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3).^3+2.*(...
(-1).*b3.*qa0+b2.*qa1+(-1).*b1.*qa2+b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*...
b0.*qa2+(-1).*b1.*qa3).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+3.*((-1).*b1.*...
qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3).*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)),(1/2).*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)...
.^2).^(-3/2).*wa.*((-1).*(b3.*qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3)...
.^2.*(1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2)+(-1).*((b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*((-1).*b1.*qa0+b0.*qa1+b3.*qa2+(-1).*b2.*qa3)+(b3.*...
qa0+(-1).*b2.*qa1+b1.*qa2+(-1).*b0.*qa3).*(b2.*qa0+b3.*qa1+(-1).*b0.*...
qa2+(-1).*b1.*qa3).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*qa3)+(-1/2)...
.*(b2.*qa0+b3.*qa1+(-1).*b0.*qa2+(-1).*b1.*qa3).^2.*(b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3)+(-1/2).*(b1.*qa0+(-1).*b0.*qa1+(-1).*b3.*qa2+b2.*...
qa3).^2.*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3)+(3/2).*((-1).*b0.*qa0+(-1).*...
b1.*qa1+(-1).*b2.*qa2+(-1).*b3.*qa3).*((-1)+(b3.*qa0+(-1).*b2.*qa1+b1.*...
qa2+(-1).*b0.*qa3).^2+(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2)).*atan2((...
1+(-1).*(b0.*qa0+b1.*qa1+b2.*qa2+b3.*qa3).^2).^(1/2),b0.*qa0+b1.*...
qa1+b2.*qa2+b3.*qa3))];
